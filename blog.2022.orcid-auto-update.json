{"kind":"Article","sha256":"ddf85d43759abab22c8c9bc6165ca09ccbdf3f81d72079c21f6a504252b76c55","slug":"blog.2022.orcid-auto-update","location":"/blog/2022/orcid-auto-update.md","dependencies":[],"frontmatter":{"title":"Automatically updating my publications page with ORCID and doi.org","tags":["scholarship","doi","orcid"],"date":"2022-11-19","content_includes_title":false,"authors":[{"id":"chris","nameParsed":{"literal":"Chris Holdgraf","given":"Chris","family":"Holdgraf"},"name":"Chris Holdgraf","orcid":"0000-0002-2391-0678","affiliations":["affiliations-myst-generated-uid-0","affiliations-myst-generated-uid-1"],"twitter":"choldgraf","github":"choldgraf","url":"https://chrisholdgraf.com"}],"github":"https://github.com/choldgraf/choldgraf.github.io","affiliations":[{"name":"2i2c","url":"https://2i2c.org","id":"affiliations-myst-generated-uid-0"},{"name":"Project Jupyter","url":"https://jupyter.org","id":"affiliations-myst-generated-uid-1"}],"exports":[{"format":"md","filename":"orcid-auto-update.md","url":"/build/orcid-auto-update-02e5a8a084840451cc9e733ba1384374.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"For a while Iâ€™ve had a hand-crafted ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"AvA1sBqcTl"},{"type":"inlineCode","value":".bibtex","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BSlLM1dUz4"},{"type":"text","value":" file stored locally for ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EPiLB1FXgQ"},{"type":"link","url":"/publications","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"my ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"wKIFbOO9np"},{"type":"inlineCode","value":"publications/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fbYpCmDa2V"},{"type":"text","value":" page","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RE6p0YPZ8S"}],"urlSource":"../../publications.md","dataUrl":"/publications.json","internal":true,"protocol":"file","key":"qb09eb5TLj"},{"type":"text","value":".\nHowever, manually updating local text file is a pain to remember, especially since there are many services out there that automatically track new publications.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"p7xG95Hzif"}],"key":"cGQEtNf2fG"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Update!","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rMlm29D8kD"}],"key":"i75fzYmfXK"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"jT9HV4yST4"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"helpful suggestion on Twitter","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"HK2EWyjm7D"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"KhWIxGJMYy"},{"type":"text","value":" allowed me to include the full citation information, including lists of authors, using the ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"aSFneJENOD"},{"type":"link","url":"http://doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pgRws6a3jt"}],"urlSource":"http://doi.org","key":"twIxJCps96"},{"type":"text","value":" API!","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"qujIN1fp61"}],"key":"hU5758qJkX"}],"key":"NLLvStsQUt"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Hereâ€™s the workflow Iâ€™d prefer:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"SYWonnbyGc"}],"key":"EkAyHgMk21"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Treat one online service provider as a ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"TMhZ0sJ2vL"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Single Source of Truth","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"SfRuWSfYMy"}],"key":"Lnk8vL5h8a"},{"type":"text","value":" for my publications list.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CTHhLCm2Uf"}],"key":"fsN1NQXMjU"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Use an API to programmatically ask this provider for the ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PMlNPP8sJS"},{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"latest","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"JQRu1dpF4S"}],"key":"Z9pFE1D593"},{"type":"text","value":" data about my publications.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"jyu80TITti"}],"key":"uoyTLcU7yP"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Reshape that data into a form that I can insert into my website.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nabjIoOCKP"}],"key":"SU7RsoqhTf"}],"key":"v9NlaYGAAE"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Hereâ€™s how I accomplished this:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"K2ptMLri3j"}],"key":"DmyjrZ8VAp"},{"type":"heading","depth":2,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Use ORCID to grab a list of DOIs for my publications","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"dkAPWXWdaq"}],"identifier":"use-orcid-to-grab-a-list-of-dois-for-my-publications","label":"Use ORCID to grab a list of DOIs for my publications","html_id":"use-orcid-to-grab-a-list-of-dois-for-my-publications","implicit":true,"key":"DOvvdy9ait"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"link","url":"https://info.orcid.org/what-is-orcid/","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"ORCID is a service for identifying scholars and their contributions","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tNEaXD9g5P"}],"urlSource":"https://info.orcid.org/what-is-orcid/","key":"GPRVKrYFvC"},{"type":"text","value":".\nIt links various kinds of publications and activities to a unique account for each person.\nIt doesnâ€™t cover ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ifV6fTriTC"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"OGeW3lGpsR"}],"key":"aAuwjFUX4o"},{"type":"text","value":" kinds of outputs (like talks, posters, etc), but it seems to cover the most important ones.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"kbhu7dmrC7"}],"key":"Pz4u97y2QB"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"ðŸ‘‰ Here is my ORCID ID and page: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"nfN9A1W7K0"},{"type":"link","url":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineCode","value":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"n5e43nNhla"}],"urlSource":"https://orcid.org/0000-0002-2391-0678","key":"L7sLmKa4qF"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"n9ScAfhBt4"}],"key":"oE9DMcec0F"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"ORCID has ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"S5pBg5os8k"},{"type":"link","url":"https://info.orcid.org/documentation/features/public-api/","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"a public-facing API","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"dE8PMiIYxZ"}],"urlSource":"https://info.orcid.org/documentation/features/public-api/","key":"VUYIqRLMg5"},{"type":"text","value":" that allows you to automatically query information about an ORCID ID.\nFollowing ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"i7hviNkyuc"},{"type":"link","url":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"an example notebook shared from the TAPIR project","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"RSca2CgVqA"}],"urlSource":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","data":{"kind":"file","org":"Project-TAPIR","repo":"pidgraph-notebooks","reference":"main","file":"person-works/orcid_get_works_by_person.ipynb","raw":"https://raw.githubusercontent.com/Project-TAPIR/pidgraph-notebooks/main/person-works/orcid_get_works_by_person.ipynb"},"internal":false,"protocol":"github","key":"NC0Fsvw6O9"},{"type":"text","value":".","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"zzy16DrQpU"}],"key":"wVU1la3GxD"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"V1nJ8ppzuV"},{"type":"link","url":"http://doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"cSYx0U6HqK"}],"urlSource":"http://doi.org","key":"UaerJaObT3"},{"type":"text","value":" API to grab citation information","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"V45xNpp3ZA"}],"identifier":"use-the-doi-org-api-to-grab-citation-information","label":"Use the doi.org API to grab citation information","html_id":"use-the-doi-org-api-to-grab-citation-information","implicit":true,"key":"pjoJ7tPG0R"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"While the ORCID API has a lot of useful information in it, there were some important pieces missing, like ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"R5SsSTPUzc"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"co-author information","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"uTT4ncGUsa"}],"key":"V8HeJw24fp"},{"type":"text","value":".\nFortunately, I learned ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"qFHYnPutcT"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"from a suggestion on Twitter","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"DrvVvJbKme"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"Dg54kYdaAI"},{"type":"text","value":" that ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"HNtFY3VTGC"},{"type":"link","url":"https://doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"GV8FUEtioK"}],"urlSource":"https://doi.org","key":"OZcJY1T2mj"},{"type":"text","value":" is accessible via an API call!","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"R1duz4GEX8"}],"key":"dAK20RrMwC"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"You can ask ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"j8nSKopxOg"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"bzdkrbVDRg"},{"type":"text","value":" for the reference, bibtex file, or a JSON structure of reference data by adding a header to a ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"zxhgOWI9Ag"},{"type":"link","url":"http://doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"dVYRjP3rbn"}],"urlSource":"http://doi.org","key":"omBcXZxJm2"},{"type":"text","value":" URL, like so:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Q3ZhOtef9G"}],"key":"bWLgsDL8qt"},{"type":"code","lang":"","value":"curl -L -H \"Accept:text/x-bibliography; style=apa\" -H \"User-Agent: mailto:youremail@email.com\" https://dx.doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":45,"column":1},"end":{"line":47,"column":1}},"key":"RdMfixFQCn"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This returns a fully-resolved reference like so:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"AwP03gW2nr"}],"key":"CLjyV2pkxd"},{"type":"code","lang":"","value":"DuPre, E., Holdgraf, C., Karakuzu, A., Tetrel, L., Bellec, P., Stikov, N., & Poline, J.-B. (2022). Beyond advertising: New infrastructures for publishing integrated research objects. PLOS Computational Biology, 18(1), e1009651. https://doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":51,"column":1},"end":{"line":53,"column":1}},"key":"Sehiz2jIFb"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"eZGwzKCUiH"}],"key":"CgYWrQQ3R1"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"xD3SKePrl1"},{"type":"inlineCode","value":"-H \"User-Agent: mailto:youremail@email.com\"","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"t9R8yiAU9m"},{"type":"text","value":" is a way to identify yourself to the ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"dTMxbkLej8"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"SGTu36m6Db"},{"type":"text","value":" API, which reduces the likelihood that you will have your access revoked.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"EzSwt6OCB4"}],"key":"rpggjQ7GZA"}],"key":"MTqSCLxBpu"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"In Python, the same call looks like this:","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"hk8IFnRHWx"}],"key":"vyw93ekQmW"},{"type":"code","lang":"python","value":"from requests import get\ndoi = \"10.1371/journal.pcbi.1009651\"\nurl = f\"https://dx.doi.org/{doi}\"\nheader = {\"accept\": \"text/x-bibliography; style=apa\", \"User-Agent\": \"mailto:youremail@email.com\"}\nr = requests.get(url, headers=header)\nprint(r.content)","position":{"start":{"line":61,"column":1},"end":{"line":68,"column":1}},"key":"eHc4ukWAfT"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"You can also use other kinds of header configuration, like:","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Ur6c1VXtxa"}],"key":"qmWUpyhzVZ"},{"type":"code","lang":"python","value":"# A citeproc-styled JSON structure\nheader = {'accept': \"citeproc+json\"}\n# A bibtex entry\nheader = {'accept': \"bibtex\"}","position":{"start":{"line":72,"column":1},"end":{"line":77,"column":1}},"key":"yNcHGkz11L"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The citeproc JSON structure has a ton of information in it, including information about all of the co-authors (and an extra bonus - a link to their ORCID pages!).\nThis is all the information I needed for my website.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"AlbXag7l33"}],"key":"hSEbEWeLWj"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"A script to do this all at once","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"QMYcWlKMl1"}],"identifier":"a-script-to-do-this-all-at-once","label":"A script to do this all at once","html_id":"a-script-to-do-this-all-at-once","implicit":true,"key":"OemYtVE0CN"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"I wrote a little script that runs each time my Sphinx site is built.\nIt generates a markdown snippet that is then inserted into my ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"AMSM4Y2wFL"},{"type":"inlineCode","value":"publications.md","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"k7jFZNxj1C"},{"type":"text","value":" page.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"zRK6kluUXa"}],"key":"W9kTLyzhVT"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Python snippet to download ORCID data","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"r7mclg9nf9"}],"key":"yWwtEJHLpg"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Note that the below is ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"Y2FV0og7wZ"},{"type":"link","url":"https://jupytext.readthedocs.io/en/latest/install.html","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"a ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"PDQArQDf0u"},{"type":"inlineCode","value":"jupytext","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"kR00XgLuwM"},{"type":"text","value":" document","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"W0w9jTby4y"}],"urlSource":"https://jupytext.readthedocs.io/en/latest/install.html","key":"iyViaLyzJl"},{"type":"text","value":" which is why thereâ€™s extra metadata at the top","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"om7mxio6Et"}],"key":"yLeUhc6kD3"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"mhRYZp8KJS"}],"key":"QX61IFxH8W"},{"type":"include","file":"../../scripts/orcid-publications.py","literal":true,"filter":{},"children":[{"type":"code","value":"# ---\n# jupyter:\n#   jupytext:\n#     formats: py:light\n#     text_representation:\n#       extension: .py\n#       format_name: light\n#       format_version: '1.5'\n#       jupytext_version: 1.14.1\n#   kernelspec:\n#     display_name: Python 3 (ipykernel)\n#     language: python\n#     name: python3\n# ---\n\n# +\nimport pandas as pd\nimport requests\nfrom IPython.display import Markdown, JSON\nfrom pathlib import Path\nfrom rich import progress\n\n# My ORCID\norcid_id = \"0000-0002-2391-0678\"\nORCID_RECORD_API = \"https://pub.orcid.org/v3.0/\"\n\n# Download all of my ORCID records\nprint(\"Retrieving ORCID entries from API...\")\nresponse = requests.get(\n    url=requests.utils.requote_uri(ORCID_RECORD_API + orcid_id),\n    headers={\"Accept\": \"application/json\"},\n)\nresponse.raise_for_status()\norcid_record = response.json()\n\n# +\n# Just to visualize in a notebook if need be\n# JSON(orcid_record)\n\n# +\n\n###\n# Resolve my DOIs from ORCID as references\n# Shamelessly copied from:\n# https://gist.github.com/brews/8d3b3ede15d120a86a6bd6fc43859c5e\nimport requests\nimport json\n\n\ndef fetchmeta(doi, fmt=\"reference\", **kwargs):\n    \"\"\"Fetch metadata for a given DOI.\n\n    Parameters\n    ----------\n    doi : str\n    fmt : str, optional\n        Desired metadata format. Can be 'dict' or 'bibtex'.\n        Default is 'dict'.\n    **kwargs :\n        Additional keyword arguments are passed to `json.loads()` if `fmt`\n        is 'dict' and you're a big JSON nerd.\n\n    Returns\n    -------\n    out : str or dict or None\n        `None` is returned if the server gives unhappy response. Usually\n        this means the DOI is bad.\n\n    Examples\n    --------\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005')\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005', 'bibtex')\n\n    References\n    ----------\n    https://www.doi.org/hb.html\n    \"\"\"\n    # Parse args and setup the server response we want.\n    accept_type = \"application/\"\n    if fmt == \"dict\":\n        accept_type += \"citeproc+json\"\n    elif fmt == \"bibtex\":\n        accept_type += \"x-bibtex\"\n    elif fmt == \"reference\":\n        accept_type = \"text/x-bibliography; style=apa\"\n    else:\n        raise ValueError(f\"Unrecognized `fmt`: {fmt}\")\n\n    # Request data from server.\n    url = \"https://dx.doi.org/\" + str(doi)\n    header = {\"accept\": accept_type}\n    r = requests.get(url, headers=header)\n\n    # Format metadata if server response is good.\n    out = None\n    if r.status_code == 200:\n        if fmt == \"dict\":\n            out = json.loads(r.text, **kwargs)\n        else:\n            out = r.text\n    return out\n\n\n# -\n\n# Extract metadata for each entry\ndf = []\nfor iwork in progress.track(\n    orcid_record[\"activities-summary\"][\"works\"][\"group\"], \"Fetching reference data...\"\n):\n    isummary = iwork[\"work-summary\"][0]\n\n    # Extract the DOI\n    for ii in isummary[\"external-ids\"][\"external-id\"]:\n        if ii[\"external-id-type\"] == \"doi\":\n            year = isummary[\"publication-date\"][\"year\"][\"value\"]\n            doi = ii[\"external-id-value\"]\n            break\n    df.append({\"year\": year, \"doi\": doi})\ndf = pd.DataFrame(df)\n\n# Convert into a markdown string\nmd = [\"|Year|Publications|\", \"|===|===|\"]\nfor year, items in df.groupby(\"year\", sort=False):\n    this_pubs = []\n    for _, item in items.iterrows():\n        this_pubs.append(f'{{cite}}`{item[\"doi\"]}`')\n    md.append(f\"|{year}|{', '.join(this_pubs)}|\")\nmds = \"\\n\".join(md)\n\n# +\n# Uncomment to preview in a notebook\n# Markdown(mds)\n# -\n\n# This will only work if this is run as a script\npath_out = Path(__file__).parent.parent / \"_static/publications.txt\"\npath_out.write_text(mds)\nprint(f\"Finished updating ORCID entries at: {path_out}\")\n","lang":"python","filename":"orcid-publications.py","key":"uJI7He7md5"}],"key":"kwsw7rYOcw"}],"key":"ncX98pUK0R"}],"key":"TC33sci8ID"}],"key":"odxjhWzDl0"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Load and plot a remote font with Matplotlib","url":"/blog/2022/matplotlib-remote-font","group":"2022"},"next":{"title":"Fix phantom GitHub workflows in your ci-cd with protected branch rules","url":"/blog/2022/phantom-workflows-pull-requests","group":"2022"}}},"domain":"http://localhost:3000"}