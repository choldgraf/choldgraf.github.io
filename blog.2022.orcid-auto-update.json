{"version":1,"kind":"Article","sha256":"ddf85d43759abab22c8c9bc6165ca09ccbdf3f81d72079c21f6a504252b76c55","slug":"blog.2022.orcid-auto-update","location":"/blog/2022/orcid-auto-update.md","dependencies":[],"frontmatter":{"title":"Automatically updating my publications page with ORCID and doi.org","tags":["scholarship","doi","orcid"],"date":"2022-11-19","content_includes_title":false,"authors":[{"id":"chris","nameParsed":{"literal":"Chris Holdgraf","given":"Chris","family":"Holdgraf"},"name":"Chris Holdgraf","orcid":"0000-0002-2391-0678","affiliations":["affiliations-myst-generated-uid-0","affiliations-myst-generated-uid-1"],"twitter":"choldgraf","github":"choldgraf","url":"https://chrisholdgraf.com"}],"github":"https://github.com/choldgraf/choldgraf.github.io","affiliations":[{"name":"2i2c","url":"https://2i2c.org","id":"affiliations-myst-generated-uid-0"},{"name":"Project Jupyter","url":"https://jupyter.org","id":"affiliations-myst-generated-uid-1"}],"abbreviations":{"LF":"The Linux Foundation","JF":"The Jupyter Foundation","JEC":"Jupyter Executive Council","JFB":"The Jupyter Foundation Board","SSC":"Software Steering Council"},"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/choldgraf/choldgraf.github.io/blob/main/blog/2022/orcid-auto-update.md","exports":[{"format":"md","filename":"orcid-auto-update.md","url":"/build/orcid-auto-update-da9745fdb723b94659c8a2c021456e54.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"For a while Iâ€™ve had a hand-crafted ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"uatndFyHE1"},{"type":"inlineCode","value":".bibtex","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"r8ylsdagQx"},{"type":"text","value":" file stored locally for ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HO2nItBsga"},{"type":"link","url":"/publications","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"my ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"zD5pr6AqSB"},{"type":"inlineCode","value":"publications/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sBOL7aUHCw"},{"type":"text","value":" page","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"EnK2LsaQOu"}],"urlSource":"../../publications.md","dataUrl":"/publications.json","internal":true,"protocol":"file","key":"mGycgVSJpY"},{"type":"text","value":".\nHowever, manually updating local text file is a pain to remember, especially since there are many services out there that automatically track new publications.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"hWr5eyiwTA"}],"key":"elwLofpsIh"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Update!","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BBxNNBlXqi"}],"key":"rgh0UcJ5Ql"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vNz9cuiLrq"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"helpful suggestion on Twitter","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"bNEyZj6sa8"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"MC9QCtPQjv"},{"type":"text","value":" allowed me to include the full citation information, including lists of authors, using the ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ntDqKJvMwx"},{"type":"link","url":"http://doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"C2KIYqhUCe"}],"urlSource":"http://doi.org","key":"pS88DUwSuj"},{"type":"text","value":" API!","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"LCFrqP7nFF"}],"key":"NOoMQCW2YH"}],"key":"iScioRd31l"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Hereâ€™s the workflow Iâ€™d prefer:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gU0dcqREfz"}],"key":"ilLHPtIPE6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Treat one online service provider as a ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"T7slPhnJTM"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Single Source of Truth","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WinNtgzaaT"}],"key":"b9XmSzeGIe"},{"type":"text","value":" for my publications list.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"hRc85nlmpF"}],"key":"zFhsH4exQW"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Use an API to programmatically ask this provider for the ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"QFnDFKD3mP"},{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"latest","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mil1fKXnAp"}],"key":"NvB5mBnNiC"},{"type":"text","value":" data about my publications.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"AcGEtqCx3W"}],"key":"WySEunpze7"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Reshape that data into a form that I can insert into my website.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"YGpnfg2ut0"}],"key":"gXMFGalbso"}],"key":"oXxCL9DgtV"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Hereâ€™s how I accomplished this:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ZlWcJz2eO7"}],"key":"d0fKmJTIis"},{"type":"heading","depth":2,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Use ORCID to grab a list of DOIs for my publications","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"WjMYb9Qagr"}],"identifier":"use-orcid-to-grab-a-list-of-dois-for-my-publications","label":"Use ORCID to grab a list of DOIs for my publications","html_id":"use-orcid-to-grab-a-list-of-dois-for-my-publications","implicit":true,"key":"RYZeeQVP3p"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"link","url":"https://info.orcid.org/what-is-orcid/","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"ORCID is a service for identifying scholars and their contributions","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"IyuVhEVW5B"}],"urlSource":"https://info.orcid.org/what-is-orcid/","key":"y8TxAsCfP0"},{"type":"text","value":".\nIt links various kinds of publications and activities to a unique account for each person.\nIt doesnâ€™t cover ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"YcFCnrXNHH"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"GDICMaDWE1"}],"key":"GAqKwg4btP"},{"type":"text","value":" kinds of outputs (like talks, posters, etc), but it seems to cover the most important ones.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"IomnD5CukQ"}],"key":"ShTDxT3rHX"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"ðŸ‘‰ Here is my ORCID ID and page: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Ksuyqy7asP"},{"type":"link","url":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineCode","value":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"FerOSd9d1w"}],"urlSource":"https://orcid.org/0000-0002-2391-0678","key":"L7SBnyYqHo"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"n7Uk3y4sy3"}],"key":"vdmORMbnqu"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"ORCID has ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"dcKsjaDEAE"},{"type":"link","url":"https://info.orcid.org/documentation/features/public-api/","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"a public-facing API","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Cbl4RsTJHA"}],"urlSource":"https://info.orcid.org/documentation/features/public-api/","key":"EqJRALEXO7"},{"type":"text","value":" that allows you to automatically query information about an ORCID ID.\nFollowing ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"h7SYuEBCJt"},{"type":"link","url":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"an example notebook shared from the TAPIR project","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"GB6LTEbhsj"}],"urlSource":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","data":{"kind":"file","org":"Project-TAPIR","repo":"pidgraph-notebooks","reference":"main","file":"person-works/orcid_get_works_by_person.ipynb","raw":"https://raw.githubusercontent.com/Project-TAPIR/pidgraph-notebooks/main/person-works/orcid_get_works_by_person.ipynb"},"internal":false,"protocol":"github","key":"bJ3WeibP9s"},{"type":"text","value":".","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"pTQu1hVSdu"}],"key":"TRMuSiDgjd"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"obfNPEKkkX"},{"type":"link","url":"http://doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Cwd6kFcZPr"}],"urlSource":"http://doi.org","key":"qJvxbODNAo"},{"type":"text","value":" API to grab citation information","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"z5Vgo7dm81"}],"identifier":"use-the-doi-org-api-to-grab-citation-information","label":"Use the doi.org API to grab citation information","html_id":"use-the-doi-org-api-to-grab-citation-information","implicit":true,"key":"zHm0jhb4eP"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"While the ORCID API has a lot of useful information in it, there were some important pieces missing, like ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ikYuJZtflV"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"co-author information","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mh1YSnqdiq"}],"key":"OH29midVDa"},{"type":"text","value":".\nFortunately, I learned ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"SJgdEyyAqq"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"from a suggestion on Twitter","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"wzznK7KDce"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"m34cmowL63"},{"type":"text","value":" that ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"qBDR2KWxkk"},{"type":"link","url":"https://doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"oqg9nsnKr1"}],"urlSource":"https://doi.org","key":"xKyr1NUe8J"},{"type":"text","value":" is accessible via an API call!","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"t7jObjBWLX"}],"key":"hNY2DeRkxB"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"You can ask ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"TOTgcPGsOu"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"awQaqY3BwY"},{"type":"text","value":" for the reference, bibtex file, or a JSON structure of reference data by adding a header to a ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"uO8XShgSGL"},{"type":"link","url":"http://doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"d9ReuTjuPb"}],"urlSource":"http://doi.org","key":"BOEJge5Y14"},{"type":"text","value":" URL, like so:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"qXLozfLd6E"}],"key":"h8gxfdzy9d"},{"type":"code","lang":"","value":"curl -L -H \"Accept:text/x-bibliography; style=apa\" -H \"User-Agent: mailto:youremail@email.com\" https://dx.doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":45,"column":1},"end":{"line":47,"column":1}},"key":"loPGjEf5Bu"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This returns a fully-resolved reference like so:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"kKxxykdJ8P"}],"key":"HfW30kElHi"},{"type":"code","lang":"","value":"DuPre, E., Holdgraf, C., Karakuzu, A., Tetrel, L., Bellec, P., Stikov, N., & Poline, J.-B. (2022). Beyond advertising: New infrastructures for publishing integrated research objects. PLOS Computational Biology, 18(1), e1009651. https://doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":51,"column":1},"end":{"line":53,"column":1}},"key":"CuLTtWzuMq"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"OeKpcTQaVX"}],"key":"ZwGPuw3Xn3"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"OZAiSBpdsq"},{"type":"inlineCode","value":"-H \"User-Agent: mailto:youremail@email.com\"","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"X54luojh2L"},{"type":"text","value":" is a way to identify yourself to the ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"UIVWSM0uc2"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"H7aMgrGYdf"},{"type":"text","value":" API, which reduces the likelihood that you will have your access revoked.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"pfydGpmG4M"}],"key":"d0wD6woRm5"}],"key":"qWiAOoMnvu"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"In Python, the same call looks like this:","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Wjnd9FtjLy"}],"key":"isKHYn9lmX"},{"type":"code","lang":"python","value":"from requests import get\ndoi = \"10.1371/journal.pcbi.1009651\"\nurl = f\"https://dx.doi.org/{doi}\"\nheader = {\"accept\": \"text/x-bibliography; style=apa\", \"User-Agent\": \"mailto:youremail@email.com\"}\nr = requests.get(url, headers=header)\nprint(r.content)","position":{"start":{"line":61,"column":1},"end":{"line":68,"column":1}},"key":"vNkBThIGr5"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"You can also use other kinds of header configuration, like:","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"LtUTio20E8"}],"key":"X7Hdf8K3bN"},{"type":"code","lang":"python","value":"# A citeproc-styled JSON structure\nheader = {'accept': \"citeproc+json\"}\n# A bibtex entry\nheader = {'accept': \"bibtex\"}","position":{"start":{"line":72,"column":1},"end":{"line":77,"column":1}},"key":"r9kB9hVsyB"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The citeproc JSON structure has a ton of information in it, including information about all of the co-authors (and an extra bonus - a link to their ORCID pages!).\nThis is all the information I needed for my website.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"q8A0PlXAnl"}],"key":"fZZZ11kEHG"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"A script to do this all at once","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"SFZdthITKn"}],"identifier":"a-script-to-do-this-all-at-once","label":"A script to do this all at once","html_id":"a-script-to-do-this-all-at-once","implicit":true,"key":"igO8P7iFAI"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"I wrote a little script that runs each time my Sphinx site is built.\nIt generates a markdown snippet that is then inserted into my ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"d2I6yrnCMV"},{"type":"inlineCode","value":"publications.md","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"qdIBdCULdP"},{"type":"text","value":" page.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"rcRkY24sMN"}],"key":"t40175fTDU"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Python snippet to download ORCID data","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"ibzPr353Qe"}],"key":"dHiW9jy8e4"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Note that the below is ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"bwSAuHXrRG"},{"type":"link","url":"https://jupytext.readthedocs.io/en/latest/install.html","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"a ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"I3B59hXQbs"},{"type":"inlineCode","value":"jupytext","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"Qv9LXPWO2T"},{"type":"text","value":" document","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"z8ePdIdS43"}],"urlSource":"https://jupytext.readthedocs.io/en/latest/install.html","key":"fcRKMrQEcI"},{"type":"text","value":" which is why thereâ€™s extra metadata at the top","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"cg7zqhKgos"}],"key":"FqAjK0sHTc"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"HZKqlUA62f"}],"key":"eoN3ENiMKz"},{"type":"include","file":"../../scripts/orcid-publications.py","literal":true,"children":[{"type":"code","value":"# ---\n# jupyter:\n#   jupytext:\n#     formats: py:light\n#     text_representation:\n#       extension: .py\n#       format_name: light\n#       format_version: '1.5'\n#       jupytext_version: 1.14.1\n#   kernelspec:\n#     display_name: Python 3 (ipykernel)\n#     language: python\n#     name: python3\n# ---\n\n# +\nimport pandas as pd\nimport requests\nfrom IPython.display import Markdown, JSON\nfrom pathlib import Path\nfrom rich import progress\n\n# My ORCID\norcid_id = \"0000-0002-2391-0678\"\nORCID_RECORD_API = \"https://pub.orcid.org/v3.0/\"\n\n# Download all of my ORCID records\nprint(\"Retrieving ORCID entries from API...\")\nresponse = requests.get(\n    url=requests.utils.requote_uri(ORCID_RECORD_API + orcid_id),\n    headers={\"Accept\": \"application/json\"},\n)\nresponse.raise_for_status()\norcid_record = response.json()\n\n# +\n# Just to visualize in a notebook if need be\n# JSON(orcid_record)\n\n# +\n\n###\n# Resolve my DOIs from ORCID as references\n# Shamelessly copied from:\n# https://gist.github.com/brews/8d3b3ede15d120a86a6bd6fc43859c5e\nimport requests\nimport json\n\n\ndef fetchmeta(doi, fmt=\"reference\", **kwargs):\n    \"\"\"Fetch metadata for a given DOI.\n\n    Parameters\n    ----------\n    doi : str\n    fmt : str, optional\n        Desired metadata format. Can be 'dict' or 'bibtex'.\n        Default is 'dict'.\n    **kwargs :\n        Additional keyword arguments are passed to `json.loads()` if `fmt`\n        is 'dict' and you're a big JSON nerd.\n\n    Returns\n    -------\n    out : str or dict or None\n        `None` is returned if the server gives unhappy response. Usually\n        this means the DOI is bad.\n\n    Examples\n    --------\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005')\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005', 'bibtex')\n\n    References\n    ----------\n    https://www.doi.org/hb.html\n    \"\"\"\n    # Parse args and setup the server response we want.\n    accept_type = \"application/\"\n    if fmt == \"dict\":\n        accept_type += \"citeproc+json\"\n    elif fmt == \"bibtex\":\n        accept_type += \"x-bibtex\"\n    elif fmt == \"reference\":\n        accept_type = \"text/x-bibliography; style=apa\"\n    else:\n        raise ValueError(f\"Unrecognized `fmt`: {fmt}\")\n\n    # Request data from server.\n    url = \"https://dx.doi.org/\" + str(doi)\n    header = {\"accept\": accept_type}\n    r = requests.get(url, headers=header)\n\n    # Format metadata if server response is good.\n    out = None\n    if r.status_code == 200:\n        if fmt == \"dict\":\n            out = json.loads(r.text, **kwargs)\n        else:\n            out = r.text\n    return out\n\n\n# -\n\n# Extract metadata for each entry\ndf = []\nfor iwork in progress.track(\n    orcid_record[\"activities-summary\"][\"works\"][\"group\"], \"Fetching reference data...\"\n):\n    isummary = iwork[\"work-summary\"][0]\n\n    # Extract the DOI\n    for ii in isummary[\"external-ids\"][\"external-id\"]:\n        if ii[\"external-id-type\"] == \"doi\":\n            year = isummary[\"publication-date\"][\"year\"][\"value\"]\n            doi = ii[\"external-id-value\"]\n            break\n    df.append({\"year\": year, \"doi\": doi})\ndf = pd.DataFrame(df)\n\n# Convert into a markdown string\nmd = [\"|Year|Publications|\", \"|===|===|\"]\nfor year, items in df.groupby(\"year\", sort=False):\n    this_pubs = []\n    for _, item in items.iterrows():\n        this_pubs.append(f'{{cite}}`{item[\"doi\"]}`')\n    md.append(f\"|{year}|{', '.join(this_pubs)}|\")\nmds = \"\\n\".join(md)\n\n# +\n# Uncomment to preview in a notebook\n# Markdown(mds)\n# -\n\n# This will only work if this is run as a script\npath_out = Path(__file__).parent.parent / \"_static/publications.txt\"\npath_out.write_text(mds)\nprint(f\"Finished updating ORCID entries at: {path_out}\")\n","lang":"python","filename":"orcid-publications.py","key":"Znz89mUPdI"}],"key":"sVnX4Y04Qu"}],"key":"b9JfMZHrt3"}],"key":"No594Go67U"}],"key":"x9Ng4l7Ivd"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Load and plot a remote font with Matplotlib","url":"/blog/2022/matplotlib-remote-font","group":"2022"},"next":{"title":"Fix phantom GitHub workflows in your ci-cd with protected branch rules","url":"/blog/2022/phantom-workflows-pull-requests","group":"2022"}}},"domain":"http://localhost:3000"}