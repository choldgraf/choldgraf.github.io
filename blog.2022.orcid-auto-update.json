{"kind":"Article","sha256":"ddf85d43759abab22c8c9bc6165ca09ccbdf3f81d72079c21f6a504252b76c55","slug":"blog.2022.orcid-auto-update","location":"/blog/2022/orcid-auto-update.md","dependencies":[],"frontmatter":{"title":"Automatically updating my publications page with ORCID and doi.org","tags":["scholarship","doi","orcid"],"date":"2022-11-19","content_includes_title":false,"github":"https://github.com/choldgraf/choldgraf.github.io","exports":[{"format":"md","filename":"orcid-auto-update.md","url":"/build/orcid-auto-update-552a86415a3be6948f09d3b31caf406b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"For a while Iâ€™ve had a hand-crafted ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"z9S1SqV436"},{"type":"inlineCode","value":".bibtex","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Db1Uqq2D4f"},{"type":"text","value":" file stored locally for ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"xbiTodjN3e"},{"type":"link","url":"/publications","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"my ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RTHUiQPB8T"},{"type":"inlineCode","value":"publications/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HGKPQhci9a"},{"type":"text","value":" page","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IWbu5QcXyo"}],"urlSource":"../../publications.md","dataUrl":"/publications.json","internal":true,"protocol":"file","key":"B2k6nS4wJS"},{"type":"text","value":".\nHowever, manually updating local text file is a pain to remember, especially since there are many services out there that automatically track new publications.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Ajzk98cMXk"}],"key":"CjRlxXKZmG"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Update!","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Urucy24rsy"}],"key":"xJ1updnz8J"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"lu9IQRmlFB"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"helpful suggestion on Twitter","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"kIUTj3tOat"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"oel1y484HG"},{"type":"text","value":" allowed me to include the full citation information, including lists of authors, using the ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"xlVn9pAv2p"},{"type":"link","url":"http://doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GYRzjg3MLg"}],"urlSource":"http://doi.org","key":"BR60zqxP8E"},{"type":"text","value":" API!","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"VCQgGUMwuh"}],"key":"a8ekEPDAHO"}],"key":"eNWxfve45q"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Hereâ€™s the workflow Iâ€™d prefer:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"HbNiBNsg2w"}],"key":"FAoiyzWMX2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Treat one online service provider as a ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"HIU7bgu3fA"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Single Source of Truth","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"HG35sLkX8o"}],"key":"fkGaBUlnzx"},{"type":"text","value":" for my publications list.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"CSmoWukihR"}],"key":"ezIwj8iG3G"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Use an API to programmatically ask this provider for the ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"IqBo0H6GxF"},{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"latest","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"vfhuYyIu1F"}],"key":"J3Ob6FXAIJ"},{"type":"text","value":" data about my publications.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"X6Gs6OwsMo"}],"key":"NAlMIOyQx6"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Reshape that data into a form that I can insert into my website.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"deaQ9D6tbs"}],"key":"P1omriSEu4"}],"key":"Nfzm7G4Oc9"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Hereâ€™s how I accomplished this:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Uy0isGCd4e"}],"key":"yEoT65EihX"},{"type":"heading","depth":2,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Use ORCID to grab a list of DOIs for my publications","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ghNAmqX5jb"}],"identifier":"use-orcid-to-grab-a-list-of-dois-for-my-publications","label":"Use ORCID to grab a list of DOIs for my publications","html_id":"use-orcid-to-grab-a-list-of-dois-for-my-publications","implicit":true,"key":"Z9D474pyFF"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"link","url":"https://info.orcid.org/what-is-orcid/","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"ORCID is a service for identifying scholars and their contributions","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"d4V2coCSew"}],"urlSource":"https://info.orcid.org/what-is-orcid/","key":"vKM1EiuQBE"},{"type":"text","value":".\nIt links various kinds of publications and activities to a unique account for each person.\nIt doesnâ€™t cover ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"fNEzeX1QpA"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZQnrMwzUFS"}],"key":"XUzRyFx0QS"},{"type":"text","value":" kinds of outputs (like talks, posters, etc), but it seems to cover the most important ones.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"O6fMs6Z9V5"}],"key":"GaX5aC7W4Q"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"ðŸ‘‰ Here is my ORCID ID and page: ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"A4ZdPZyx5P"},{"type":"link","url":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineCode","value":"https://orcid.org/0000-0002-2391-0678","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"i9sNaovIAt"}],"urlSource":"https://orcid.org/0000-0002-2391-0678","key":"UtHbKIVhJW"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"UrayDUnJyG"}],"key":"JSMkhW7OFl"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"ORCID has ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"C5VCPDuJdI"},{"type":"link","url":"https://info.orcid.org/documentation/features/public-api/","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"a public-facing API","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"SzI9SkzGGE"}],"urlSource":"https://info.orcid.org/documentation/features/public-api/","key":"RBASh85ugm"},{"type":"text","value":" that allows you to automatically query information about an ORCID ID.\nFollowing ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Rov3tYZX3W"},{"type":"link","url":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"an example notebook shared from the TAPIR project","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"NFiTIboC1M"}],"urlSource":"https://github.com/Project-TAPIR/pidgraph-notebooks/blob/main/person-works/orcid_get_works_by_person.ipynb","data":{"kind":"file","org":"Project-TAPIR","repo":"pidgraph-notebooks","reference":"main","file":"person-works/orcid_get_works_by_person.ipynb","raw":"https://raw.githubusercontent.com/Project-TAPIR/pidgraph-notebooks/main/person-works/orcid_get_works_by_person.ipynb"},"internal":false,"protocol":"github","key":"ZvxNP9nG7l"},{"type":"text","value":".","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ixiTUuZfRz"}],"key":"xsJ6LRacv3"},{"type":"heading","depth":2,"position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"DWn90v3ozK"},{"type":"link","url":"http://doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"LxoNpdP8B8"}],"urlSource":"http://doi.org","key":"GXKiCmZhm5"},{"type":"text","value":" API to grab citation information","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"BMEjGBG58m"}],"identifier":"use-the-doi-org-api-to-grab-citation-information","label":"Use the doi.org API to grab citation information","html_id":"use-the-doi-org-api-to-grab-citation-information","implicit":true,"key":"ZKWIzuA4t4"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"While the ORCID API has a lot of useful information in it, there were some important pieces missing, like ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"IOQFI8SjyI"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"co-author information","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"SE1Kq0sDac"}],"key":"JrU4WqdaRV"},{"type":"text","value":".\nFortunately, I learned ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"fI4wMJq5Eq"},{"type":"link","url":"https://twitter.com/temorrell/status/1594749942316208128","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"from a suggestion on Twitter","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mgq4PoAbns"}],"urlSource":"https://twitter.com/temorrell/status/1594749942316208128","key":"n9YO46qJo5"},{"type":"text","value":" that ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"I2bTHykrvm"},{"type":"link","url":"https://doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"pHjvGxJSqV"}],"urlSource":"https://doi.org","key":"McLr0e6dDw"},{"type":"text","value":" is accessible via an API call!","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"uJfBSEL8YE"}],"key":"exlK9prWsi"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"You can ask ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"BfH6rM5zcZ"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"BGNPjzeIJl"},{"type":"text","value":" for the reference, bibtex file, or a JSON structure of reference data by adding a header to a ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"B8IJWbPzF3"},{"type":"link","url":"http://doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"doi.org","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"cacNwS2QQp"}],"urlSource":"http://doi.org","key":"WicC1Pepc9"},{"type":"text","value":" URL, like so:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ADGizoleEn"}],"key":"dakjyYMgvl"},{"type":"code","lang":"","value":"curl -L -H \"Accept:text/x-bibliography; style=apa\" -H \"User-Agent: mailto:youremail@email.com\" https://dx.doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":45,"column":1},"end":{"line":47,"column":1}},"key":"m4zQzHtJnk"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This returns a fully-resolved reference like so:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"sNqfSomNuP"}],"key":"LRk4JwrVKy"},{"type":"code","lang":"","value":"DuPre, E., Holdgraf, C., Karakuzu, A., Tetrel, L., Bellec, P., Stikov, N., & Poline, J.-B. (2022). Beyond advertising: New infrastructures for publishing integrated research objects. PLOS Computational Biology, 18(1), e1009651. https://doi.org/10.1371/journal.pcbi.1009651","position":{"start":{"line":51,"column":1},"end":{"line":53,"column":1}},"key":"GOLYmCG6y6"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"MryDs72MjZ"}],"key":"uxxn4BQOMf"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"ZfKDLbW3m7"},{"type":"inlineCode","value":"-H \"User-Agent: mailto:youremail@email.com\"","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"X4jnyRzs5e"},{"type":"text","value":" is a way to identify yourself to the ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"CFP88XdVFb"},{"type":"inlineCode","value":"doi.org","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"zNfv2uEy6G"},{"type":"text","value":" API, which reduces the likelihood that you will have your access revoked.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"PPc6ix2Zvm"}],"key":"cncTTXaZNe"}],"key":"Lj5OUmHlPI"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"In Python, the same call looks like this:","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ZaUcnKVyjE"}],"key":"a1u8Ay6glq"},{"type":"code","lang":"python","value":"from requests import get\ndoi = \"10.1371/journal.pcbi.1009651\"\nurl = f\"https://dx.doi.org/{doi}\"\nheader = {\"accept\": \"text/x-bibliography; style=apa\", \"User-Agent\": \"mailto:youremail@email.com\"}\nr = requests.get(url, headers=header)\nprint(r.content)","position":{"start":{"line":61,"column":1},"end":{"line":68,"column":1}},"key":"drVV5Jtqjv"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"You can also use other kinds of header configuration, like:","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"yNFfN1lClU"}],"key":"o1JGkZfE76"},{"type":"code","lang":"python","value":"# A citeproc-styled JSON structure\nheader = {'accept': \"citeproc+json\"}\n# A bibtex entry\nheader = {'accept': \"bibtex\"}","position":{"start":{"line":72,"column":1},"end":{"line":77,"column":1}},"key":"SVoolHbH2m"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"The citeproc JSON structure has a ton of information in it, including information about all of the co-authors (and an extra bonus - a link to their ORCID pages!).\nThis is all the information I needed for my website.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"nnVxtbpj4K"}],"key":"dYDOg9yb2S"},{"type":"heading","depth":2,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"A script to do this all at once","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"B2vc9JqKnt"}],"identifier":"a-script-to-do-this-all-at-once","label":"A script to do this all at once","html_id":"a-script-to-do-this-all-at-once","implicit":true,"key":"WJzABu4sib"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"I wrote a little script that runs each time my Sphinx site is built.\nIt generates a markdown snippet that is then inserted into my ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"ds9aDcZDtp"},{"type":"inlineCode","value":"publications.md","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"cz6oT5sbzv"},{"type":"text","value":" page.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"VyYFV1MFDj"}],"key":"M8GZUBh4oG"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Python snippet to download ORCID data","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"cwu4ZK46v6"}],"key":"aTjIi18WUD"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Note that the below is ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"hBTVRNTx2b"},{"type":"link","url":"https://jupytext.readthedocs.io/en/latest/install.html","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"a ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"OnflY1988M"},{"type":"inlineCode","value":"jupytext","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"yWa3eSobZ4"},{"type":"text","value":" document","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"iVaAxKorfz"}],"urlSource":"https://jupytext.readthedocs.io/en/latest/install.html","key":"lb9TlpLvO1"},{"type":"text","value":" which is why thereâ€™s extra metadata at the top","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"ohHoKBkB1D"}],"key":"DooEKrlGBg"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"szoohTm0fV"}],"key":"Cd2q8etCJu"},{"type":"include","file":"../../scripts/orcid-publications.py","literal":true,"filter":{},"children":[{"type":"code","value":"# ---\n# jupyter:\n#   jupytext:\n#     formats: py:light\n#     text_representation:\n#       extension: .py\n#       format_name: light\n#       format_version: '1.5'\n#       jupytext_version: 1.14.1\n#   kernelspec:\n#     display_name: Python 3 (ipykernel)\n#     language: python\n#     name: python3\n# ---\n\n# +\nimport pandas as pd\nimport requests\nfrom IPython.display import Markdown, JSON\nfrom pathlib import Path\nfrom rich import progress\n\n# My ORCID\norcid_id = \"0000-0002-2391-0678\"\nORCID_RECORD_API = \"https://pub.orcid.org/v3.0/\"\n\n# Download all of my ORCID records\nprint(\"Retrieving ORCID entries from API...\")\nresponse = requests.get(\n    url=requests.utils.requote_uri(ORCID_RECORD_API + orcid_id),\n    headers={\"Accept\": \"application/json\"},\n)\nresponse.raise_for_status()\norcid_record = response.json()\n\n# +\n# Just to visualize in a notebook if need be\n# JSON(orcid_record)\n\n# +\n\n###\n# Resolve my DOIs from ORCID as references\n# Shamelessly copied from:\n# https://gist.github.com/brews/8d3b3ede15d120a86a6bd6fc43859c5e\nimport requests\nimport json\n\n\ndef fetchmeta(doi, fmt=\"reference\", **kwargs):\n    \"\"\"Fetch metadata for a given DOI.\n\n    Parameters\n    ----------\n    doi : str\n    fmt : str, optional\n        Desired metadata format. Can be 'dict' or 'bibtex'.\n        Default is 'dict'.\n    **kwargs :\n        Additional keyword arguments are passed to `json.loads()` if `fmt`\n        is 'dict' and you're a big JSON nerd.\n\n    Returns\n    -------\n    out : str or dict or None\n        `None` is returned if the server gives unhappy response. Usually\n        this means the DOI is bad.\n\n    Examples\n    --------\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005')\n    >>> fetchmeta('10.1016/j.dendro.2018.02.005', 'bibtex')\n\n    References\n    ----------\n    https://www.doi.org/hb.html\n    \"\"\"\n    # Parse args and setup the server response we want.\n    accept_type = \"application/\"\n    if fmt == \"dict\":\n        accept_type += \"citeproc+json\"\n    elif fmt == \"bibtex\":\n        accept_type += \"x-bibtex\"\n    elif fmt == \"reference\":\n        accept_type = \"text/x-bibliography; style=apa\"\n    else:\n        raise ValueError(f\"Unrecognized `fmt`: {fmt}\")\n\n    # Request data from server.\n    url = \"https://dx.doi.org/\" + str(doi)\n    header = {\"accept\": accept_type}\n    r = requests.get(url, headers=header)\n\n    # Format metadata if server response is good.\n    out = None\n    if r.status_code == 200:\n        if fmt == \"dict\":\n            out = json.loads(r.text, **kwargs)\n        else:\n            out = r.text\n    return out\n\n\n# -\n\n# Extract metadata for each entry\ndf = []\nfor iwork in progress.track(\n    orcid_record[\"activities-summary\"][\"works\"][\"group\"], \"Fetching reference data...\"\n):\n    isummary = iwork[\"work-summary\"][0]\n\n    # Extract the DOI\n    for ii in isummary[\"external-ids\"][\"external-id\"]:\n        if ii[\"external-id-type\"] == \"doi\":\n            year = isummary[\"publication-date\"][\"year\"][\"value\"]\n            doi = ii[\"external-id-value\"]\n            break\n    df.append({\"year\": year, \"doi\": doi})\ndf = pd.DataFrame(df)\n\n# Convert into a markdown string\nmd = [\"|Year|Publications|\", \"|===|===|\"]\nfor year, items in df.groupby(\"year\", sort=False):\n    this_pubs = []\n    for _, item in items.iterrows():\n        this_pubs.append(f'{{cite}}`{item[\"doi\"]}`')\n    md.append(f\"|{year}|{', '.join(this_pubs)}|\")\nmds = \"\\n\".join(md)\n\n# +\n# Uncomment to preview in a notebook\n# Markdown(mds)\n# -\n\n# This will only work if this is run as a script\npath_out = Path(__file__).parent.parent / \"_static/publications.txt\"\npath_out.write_text(mds)\nprint(f\"Finished updating ORCID entries at: {path_out}\")\n","lang":"python","filename":"orcid-publications.py","key":"K5uNN0eJGy"}],"key":"BgNXXBIaGY"}],"key":"VHKpcFABTU"}],"key":"HgyIkLe8Ua"}],"key":"URtbqaR1HP"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Load and plot a remote font with Matplotlib","url":"/blog/2022/matplotlib-remote-font","group":"2022"},"next":{"title":"Fix phantom GitHub workflows in your ci-cd with protected branch rules","url":"/blog/2022/phantom-workflows-pull-requests","group":"2022"}}},"domain":"http://localhost:3000"}