{"kind":"Article","sha256":"47438f5605a1a1543e8e8b10f88340cf40486029335f6aaf7d5ddc8c906f1cc4","slug":"blog.2022.phantom-workflows-pull-requests","location":"/blog/2022/phantom-workflows-pull-requests.md","dependencies":[],"frontmatter":{"title":"Fix phantom GitHub workflows in your ci-cd with protected branch rules","tags":["cicd","github actions"],"date":"2022-11-27","content_includes_title":false,"authors":[{"id":"chris","nameParsed":{"literal":"Chris Holdgraf","given":"Chris","family":"Holdgraf"},"name":"Chris Holdgraf","orcid":"0000-0002-2391-0678","affiliations":["affiliations-myst-generated-uid-0","affiliations-myst-generated-uid-1"],"twitter":"choldgraf","github":"choldgraf","url":"https://chrisholdgraf.com"}],"github":"https://github.com/choldgraf/choldgraf.github.io","affiliations":[{"name":"2i2c","url":"https://2i2c.org","id":"affiliations-myst-generated-uid-0"},{"name":"Project Jupyter","url":"https://jupyter.org","id":"affiliations-myst-generated-uid-1"}],"thumbnail":"/build/abdd690fd5af613c25b40bb16d6ca824.png","exports":[{"format":"md","filename":"phantom-workflows-pull-requests.md","url":"/build/phantom-workflows-pu-6bab27de35e7d418cd9f396155d34ede.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Have you ever had a GitHub pull request show “phantom” workflows that never pass?\nThis looks like one or more workflows that are in a constant ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"daHVB0EhfG"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"waiting state","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hu1XaUgOgg"}],"key":"b6hOBAzeAY"},{"type":"text","value":", with a yellow status indicator, and that never complete.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CLXBeaOcv8"}],"key":"l7uUH15S26"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"It looks something like this:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"nCIDclCLgD"}],"key":"cFjGph2cKI"},{"type":"image","url":"/build/abdd690fd5af613c25b40bb16d6ca824.png","align":"center","key":"GW1mvfSv8G","urlSource":"https://user-images.githubusercontent.com/1839645/204134864-da2541f0-ff4f-4d9f-8c80-aa8c4437d8a0.png"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"If you run into this, it may be because of ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZEG6ldT3Os"},{"type":"link","url":"https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/about-protected-branches","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"branch protection rules","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"aZmNSyykk4"}],"urlSource":"https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/about-protected-branches","key":"LmKVLq3OXJ"},{"type":"text","value":" in their repository.\nThese allow you to ensure that certain conditions are met before a pull request can be merged.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KSybNBZrNn"}],"key":"NMbYyl1718"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"In particular, a common step is to ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"DdLZ5Psxif"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"ensure that a certain GitHub Workflow passes before you can merge","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PGOZX43xsv"}],"key":"apZLdMXqjE"},{"type":"text","value":".\nThis is often the source of the phantom workflows that never complete.\nThis is configured via ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"S1mjEL3FC6"},{"type":"inlineCode","value":"settings","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"FzhghkrZrJ"},{"type":"text","value":" -> ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"qXsQ9ZU1G6"},{"type":"inlineCode","value":"branches","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mEPOupdaos"},{"type":"text","value":" -> ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"dJImQTgd9m"},{"type":"inlineCode","value":"branch protection rules","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"LC7H4ts18k"},{"type":"text","value":", like so:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"g6gn3Qf8DX"}],"key":"g9aO7SMz3I"},{"type":"image","url":"/build/0c07afb2ee1b1197062aaa96da4cc14c.png","align":"center","key":"VrMsAdyXSb","urlSource":"https://user-images.githubusercontent.com/1839645/204134952-fb5b8aa5-f8bb-4bd9-92ec-c66bf653387a.png"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"If you ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"wZVXPr3o2D"},{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"specify a test here, and then delete it in your ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"kXaEvbybRb"},{"type":"inlineCode","value":"YAML","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"UefMxftpY7"},{"type":"text","value":" configuration file, this will cause phantom workflows in your Pull Requests","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"lVNR9IoXZB"}],"key":"PZx7prOtiO"},{"type":"text","value":".\nGitHub will wait for the test to finish, because it is specified in your repository settings, but it will never finish because the test isn’t configured in your workflow configuration.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"DlLbZo07Ih"}],"key":"JmGjbAUbHy"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"So, to fix it, you simply ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"rrdwImIP3S"},{"type":"strong","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"delete the entry in your protected branch rules associated with that test","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"s3D3UG1jl9"}],"key":"kGXavPWeZk"},{"type":"text","value":".\nAs a result, GitHub will no longer wait for that test to complete, and you can merge away.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"eRBZg98PEb"}],"key":"Q7gOvrRvRY"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"This one has bitten me several times, and so I decided to just document it here for future reference.\n","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"OgyD8tNVrj"},{"type":"link","url":"https://jacobtomlinson.dev/","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Jacob Tomlinson","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"HcXyI2fyDB"}],"urlSource":"https://jacobtomlinson.dev/","key":"SyRr6JQm8D"},{"type":"text","value":" was the one that first told me about this fix!","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"wMMZpuJTaw"}],"key":"LcuIjLKvy3"}],"key":"ETANgHzIqJ"}],"key":"Xs96WnBMmX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Automatically updating my publications page with ORCID and doi.org","url":"/blog/2022/orcid-auto-update","group":"2022"},"next":{"title":"Automatically update pre-commit hook versions","url":"/blog/2022/precommit-autoupdate","group":"2022"}}},"domain":"http://localhost:3000"}