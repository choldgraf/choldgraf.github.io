{"kind":"Article","sha256":"fddf911de394d351ebe3e193508020bca41c2fbcfdca99e00573f81480d18423","slug":"blog.2023.social-directive","location":"/blog/2023/social-directive.md","dependencies":[],"frontmatter":{"title":"A Sphinx directive for social media embeds","tags":["sphinx"],"date":"2023-02-15","content_includes_title":false,"github":"https://github.com/choldgraf/choldgraf.github.io","exports":[{"format":"md","filename":"social-directive.md","url":"/build/social-directive-8ffae588717633a8c88b88c9ff0166ca.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"This probably doesn’t work anymore","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Ux7jUtpE7Q"}],"key":"hzyK5p5Z3h"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"I’ve since moved my blog to use ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"B4MVnspg6x"},{"type":"link","url":"https://mystmd.org","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"the MyST Document Engine","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kzIUiEOKhL"}],"urlSource":"https://mystmd.org","key":"ZtvkBUDVZF"},{"type":"text","value":" so this example will no longer work on my personal blog. See ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nZNuCnlXBa"},{"type":"link","url":"https://github.com/choldgraf/choldgraf.github.io/blob/ae8ee9792c74aac72f46c645d19352abc439d572/blog/2023/social-directive.md","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"this permalink for the latest working version","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UhnVxX9ty8"}],"urlSource":"https://github.com/choldgraf/choldgraf.github.io/blob/ae8ee9792c74aac72f46c645d19352abc439d572/blog/2023/social-directive.md","data":{"kind":"file","org":"choldgraf","repo":"choldgraf.github.io","reference":"ae8ee9792c74aac72f46c645d19352abc439d572","file":"blog/2023/social-directive.md","raw":"https://raw.githubusercontent.com/choldgraf/choldgraf.github.io/ae8ee9792c74aac72f46c645d19352abc439d572/blog/2023/social-directive.md"},"internal":false,"protocol":"github","key":"WJXS4BY1SQ"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jZSBv7S09O"}],"key":"pi2KSm5jMm"}],"key":"DBtKAXAVKj"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"I often want to link to social and other types of web-based media in my Sphinx documentation and blog.\nRather than embedding it all in custom HTML code, I decided to write a little wrapper to turn it into a directive.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GTYR9xZFUL"}],"key":"GW2Uw3xPOf"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"It’s called ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"K4tAwtaxBA"},{"type":"inlineCode","value":"{socialpost}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yaYqObgvsp"},{"type":"text","value":", and it works with Twitter, Mastodon, and YouTube links.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wivpsjHYqV"}],"key":"qfiirctz7S"},{"type":"heading","depth":2,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"How it works","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"kn0QRpFsas"}],"identifier":"how-it-works","label":"How it works","html_id":"how-it-works","implicit":true,"key":"p8odgZYIaW"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Here’s a brief description of how this directive works:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"sf4Y2DM9B2"}],"key":"FBBtU6EyYN"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Parse the directive content (the thing that comes after ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"EvBjHZfAvz"},{"type":"inlineCode","value":"{socialpost}","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"hdI7bY27FS"},{"type":"text","value":", e.g. ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"cPG3TjXD5p"},{"type":"inlineCode","value":"https://twitter.com/choldgraf/status/1564614538309390345","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"bpabcsesl1"},{"type":"text","value":")","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"CXyILNLmZc"}],"key":"Jg7g0OeL9L"}],"key":"LTfn7zJH2b"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Do some basic pattern matching to decide if it is Twitter / Mastodon / YouTube","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"RWZAXCUdNa"}],"key":"nJiHNZhOAb"}],"key":"PRSv4qIHnV"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Parse the URL for the proper unique identifier for the post (e.g. above it is ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"RnDeSsvjp1"},{"type":"inlineCode","value":"1564614538309390345","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"AeJ8mWUMZg"},{"type":"text","value":")","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"LVVpa6mUNA"}],"key":"OvBp9jNYsN"}],"key":"tgbDYlntTY"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Use an embed template that embeds this identifier into each service. E.g., for Twitter it is:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kg6X3wBa6w"}],"key":"BjtTrbIDs6"},{"type":"code","lang":"html","value":"<blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">\n  <a href=\"https://twitter.com/choldgraf/status/1564614538309390345\">Tweet from @choldgraf</a>\n</blockquote>","position":{"start":{"line":28,"column":1},"end":{"line":32,"column":1}},"key":"Xs2ZNSqIi6"}],"key":"svZyun9n0M"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"This is all wrapped up in a ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"SSPnSOo8v3"},{"type":"inlineCode","value":"Directive","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mmmER7uAIp"},{"type":"text","value":" object that outputs an HTML ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"hFkp7z3g9X"},{"type":"inlineCode","value":"raw","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mGB8RCWE5B"},{"type":"text","value":" node so I can pass through raw HTML.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"aWxzq5LXrx"}],"key":"bn7opACnZf"}],"key":"G9zmnfoBUY"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Load any necessary JS files if this directive is detected on a page.\nThis is done with an ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"f2OSscn4iG"},{"type":"inlineCode","value":"html-page-context","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"JxryUSQjAd"},{"type":"text","value":" event.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"Noa25gRv6F"}],"key":"oDWiwt0XOZ"}],"key":"N2XXyCiJWk"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"I then connected them both to Sphinx in my site’s ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"b4lZsphGTi"},{"type":"inlineCode","value":"conf.py","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"uNUET3WsOq"},{"type":"text","value":" setup function.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"PZevqGWfPv"}],"key":"TxzhIgC8D1"}],"key":"UURo1OrcVE"}],"key":"LcooHTS862"}],"key":"vMwpv7CpFU"}],"key":"IxM5eA0K5q"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Report from FOSDEM23: beautiful chaos in a conference","url":"/blog/2023/fosdem","group":"2023"},"next":{"title":"Bundle extensions with your Sphinx theme","url":"/blog/2023/sphinx-add-extensions","group":"2023"}}},"domain":"http://localhost:3000"}